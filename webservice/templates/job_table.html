{%extends "layout.html"%}

{%block title%}
    <title>POMS</title>

    <style type="text/css">
    div.scrollable {
        width: 100%;
        overflow-x: scroll;
    }
    div.scrollable table {
        width: 300%;
    }
    </style>
{%endblock%}


{%block breadcrumbs%}
<div class="ui breadcrumb" style="margin-top: -45px;">
  <a href="{{pomspath}}/" class="section">Home</a>
  <div class="divider"> / </div>
  <div class="section">All Jobs</div>
</div>
{%endblock%}



{%block header%}
<h1 class="ui header">
    Jobs
</h1>
<div class="ui subheader">
{{days}} Days of Jobs ending {{tmax}} {{extra}}
</div>

<a href="{{prev}}">&lt;previous {{days}} days</a> | 
<a href="{{next}}">next {{days}} days &gt;</a>
{%endblock%}






{%block subheader%}
{%endblock%}



{%block content%}
<div class="scrollable">
<table id="jobtable" class="ui celled sortable table compact">
  <thead>
    <tr>
      {%set span1 = [] %}
      {%for col in jobcolumns %}
        {% if not col in hidecolumns %}
          <!--{{span1.append(1)}}-->
        {% endif %}
      {% endfor %}
      <!-- span1 {{span1}} -->
      <th class="" colspan="{{span1|length}}">Job fields</th>
      {%set span2 = [] %}
      {%for col in taskcolumns %}
        {% if not col in hidecolumns %}
          <!--{{span2.append(1)}}-->
        {% endif %}
      {% endfor %}
      <!-- span2 {{span2}} -->
      <th class="" colspan="{{span2|length}}">Task fields</th>
      {%set span3 = campcolumns|length %}
      <th class="" colspan="{{span3}}">Campaign fields</th>
    </tr>
    <tr>
    {%for col in jobcolumns%}
      {% if loop.first %}
       <th class="">info</th>
      {% else %}
        {% if not col in hidecolumns %}
         <th class="">{{col|replace("_","<br>")}}</th>
        {% endif %}
      {% endif %}
    {%endfor%}
    {%for col in taskcolumns%}
      {% if not col in hidecolumns %}
       <th class="">{{col|replace("_","<br>")}}</th>
      {% endif %}
    {%endfor%}
    {%for col in campcolumns%}
      {% if not col in hidecolumns %}
       <th class="">{{col|replace("_","<br>")}}</th>
      {% endif %}
    {%endfor%}
    </tr>
  </thead>
  <tbody>
    {%for job,task,campaign in joblist %}
      <tr>
         {%for col in jobcolumns%}
            {% if loop.first %}
              <td><a href="{{pomspath}}/triage_job?job_id={{job[col]}}&tmin={{tmin}}"><i class="level down icon"></i> </a></td>
            {% else %}
             {% if not col in hidecolumns %}
              <td>{{job[col]}}</td>
             {% endif %}
            {% endif %}
         {%endfor%}
         {%for col in taskcolumns%}
             {% if not col in hidecolumns %}
              <td>{{task[col]}}</td>
             {% endif %}
         {%endfor%}
         {%for col in campcolumns%}
             {% if not col in hidecolumns %}
              <td>{{campaign[col]}}</td>
             {% endif %}
         {%endfor%}
      </tr>
    {%endfor%}
  </tbody>
</table>
</div>
</script>

{%endblock%}
